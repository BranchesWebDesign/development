(function(){var p=this,k=p._,h={},n=Array.prototype,r=Object.prototype,s=n.push,m=n.slice,q=n.concat,v=r.toString,z=r.hasOwnProperty,D=n.forEach,y=n.map,w=n.reduce,I=n.reduceRight,J=n.filter,K=n.every,L=n.some,x=n.indexOf,M=n.lastIndexOf,r=Array.isArray,N=Object.keys,E=Function.prototype.bind,c=function(d){return d instanceof c?d:this instanceof c?void(this._wrapped=d):new c(d)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=c),exports._=c):p._=c;
c.VERSION="1.6.0";var l=c.each=c.forEach=function(d,a,b){if(null==d)return d;if(D&&d.forEach===D)d.forEach(a,b);else if(d.length===+d.length)for(var e=0,f=d.length;f>e;e++){if(a.call(b,d[e],e,d)===h)return}else for(var P=c.keys(d),e=0,f=P.length;f>e;e++)if(a.call(b,d[P[e]],P[e],d)===h)return;return d};c.map=c.collect=function(d,a,b){var c=[];return null==d?c:y&&d.map===y?d.map(a,b):(l(d,function(d,e,f){c.push(a.call(b,d,e,f))}),c)};c.reduce=c.foldl=c.inject=function(d,a,b,e){var f=2<arguments.length;
if(null==d&&(d=[]),w&&d.reduce===w)return e&&(a=c.bind(a,e)),f?d.reduce(a,b):d.reduce(a);if(l(d,function(d,c,g){f?b=a.call(e,b,d,c,g):(b=d,f=!0)}),!f)throw new TypeError("Reduce of empty array with no initial value");return b};c.reduceRight=c.foldr=function(d,a,b,e){var f=2<arguments.length;if(null==d&&(d=[]),I&&d.reduceRight===I)return e&&(a=c.bind(a,e)),f?d.reduceRight(a,b):d.reduceRight(a);var g=d.length;if(g!==+g)var h=c.keys(d),g=h.length;if(l(d,function(c,k,m){k=h?h[--g]:--g;f?b=a.call(e,b,
d[k],k,m):(b=d[k],f=!0)}),!f)throw new TypeError("Reduce of empty array with no initial value");return b};c.find=c.detect=function(d,a,b){var c;return t(d,function(d,e,f){return a.call(b,d,e,f)?(c=d,!0):void 0}),c};c.filter=c.select=function(d,a,b){var c=[];return null==d?c:J&&d.filter===J?d.filter(a,b):(l(d,function(d,e,f){a.call(b,d,e,f)&&c.push(d)}),c)};c.reject=function(d,a,b){return c.filter(d,function(d,c,e){return!a.call(b,d,c,e)},b)};c.every=c.all=function(d,a,b){a||(a=c.identity);var e=!0;
return null==d?e:K&&d.every===K?d.every(a,b):(l(d,function(d,c,f){return(e=e&&a.call(b,d,c,f))?void 0:h}),!!e)};var t=c.some=c.any=function(d,a,b){a||(a=c.identity);var e=!1;return null==d?e:L&&d.some===L?d.some(a,b):(l(d,function(d,c,f){return e||(e=a.call(b,d,c,f))?h:void 0}),!!e)};c.contains=c.include=function(d,a){return null==d?!1:x&&d.indexOf===x?-1!=d.indexOf(a):t(d,function(d){return d===a})};c.invoke=function(d,a){var b=m.call(arguments,2),e=c.isFunction(a);return c.map(d,function(d){return(e?
a:d[a]).apply(d,b)})};c.pluck=function(d,a){return c.map(d,c.property(a))};c.where=function(d,a){return c.filter(d,c.matches(a))};c.findWhere=function(d,a){return c.find(d,c.matches(a))};c.max=function(d,a,b){if(!a&&c.isArray(d)&&d[0]===+d[0]&&65535>d.length)return Math.max.apply(Math,d);var e=-1/0,f=-1/0;return l(d,function(d,c,g){c=a?a.call(b,d,c,g):d;c>f&&(e=d,f=c)}),e};c.min=function(d,a,b){if(!a&&c.isArray(d)&&d[0]===+d[0]&&65535>d.length)return Math.min.apply(Math,d);var e=1/0,f=1/0;return l(d,
function(d,c,g){c=a?a.call(b,d,c,g):d;f>c&&(e=d,f=c)}),e};c.shuffle=function(d){var a,b=0,e=[];return l(d,function(d){a=c.random(b++);e[b-1]=e[a];e[a]=d}),e};c.sample=function(d,a,b){return null==a||b?(d.length!==+d.length&&(d=c.values(d)),d[c.random(d.length-1)]):c.shuffle(d).slice(0,Math.max(0,a))};var B=function(d){return null==d?c.identity:c.isFunction(d)?d:c.property(d)};c.sortBy=function(d,a,b){return a=B(a),c.pluck(c.map(d,function(d,c,e){return{value:d,index:c,criteria:a.call(b,d,c,e)}}).sort(function(d,
a){var b=d.criteria,c=a.criteria;if(b!==c){if(b>c||void 0===b)return 1;if(c>b||void 0===c)return-1}return d.index-a.index}),"value")};var F=function(d){return function(a,b,c){var e={};return b=B(b),l(a,function(f,g){var h=b.call(c,f,g,a);d(e,h,f)}),e}};c.groupBy=F(function(d,a,b){c.has(d,a)?d[a].push(b):d[a]=[b]});c.indexBy=F(function(d,a,b){d[a]=b});c.countBy=F(function(d,a){c.has(d,a)?d[a]++:d[a]=1});c.sortedIndex=function(d,a,b,c){b=B(b);a=b.call(c,a);for(var e=0,f=d.length;f>e;){var g=e+f>>>1;
b.call(c,d[g])<a?e=g+1:f=g}return e};c.toArray=function(d){return d?c.isArray(d)?m.call(d):d.length===+d.length?c.map(d,c.identity):c.values(d):[]};c.size=function(d){return null==d?0:d.length===+d.length?d.length:c.keys(d).length};c.first=c.head=c.take=function(d,a,b){return null==d?void 0:null==a||b?d[0]:0>a?[]:m.call(d,0,a)};c.initial=function(d,a,b){return m.call(d,0,d.length-(null==a||b?1:a))};c.last=function(d,a,b){return null==d?void 0:null==a||b?d[d.length-1]:m.call(d,Math.max(d.length-a,
0))};c.rest=c.tail=c.drop=function(d,a,b){return m.call(d,null==a||b?1:a)};c.compact=function(d){return c.filter(d,c.identity)};var O=function(d,a,b){return a&&c.every(d,c.isArray)?q.apply(b,d):(l(d,function(d){c.isArray(d)||c.isArguments(d)?a?s.apply(b,d):O(d,a,b):b.push(d)}),b)};c.flatten=function(d,a){return O(d,a,[])};c.without=function(d){return c.difference(d,m.call(arguments,1))};c.partition=function(d,a){var b=[],c=[];return l(d,function(d){(a(d)?b:c).push(d)}),[b,c]};c.uniq=c.unique=function(d,
a,b,e){c.isFunction(a)&&(e=b,b=a,a=!1);b=b?c.map(d,b,e):d;var f=[],g=[];return l(b,function(b,e){(a?e&&g[g.length-1]===b:c.contains(g,b))||(g.push(b),f.push(d[e]))}),f};c.union=function(){return c.uniq(c.flatten(arguments,!0))};c.intersection=function(d){var a=m.call(arguments,1);return c.filter(c.uniq(d),function(d){return c.every(a,function(a){return c.contains(a,d)})})};c.difference=function(d){var a=q.apply(n,m.call(arguments,1));return c.filter(d,function(d){return!c.contains(a,d)})};c.zip=function(){for(var d=
c.max(c.pluck(arguments,"length").concat(0)),a=Array(d),b=0;d>b;b++)a[b]=c.pluck(arguments,""+b);return a};c.object=function(d,a){if(null==d)return{};for(var b={},c=0,e=d.length;e>c;c++)a?b[d[c]]=a[c]:b[d[c][0]]=d[c][1];return b};c.indexOf=function(d,a,b){if(null==d)return-1;var e=0,f=d.length;if(b){if("number"!=typeof b)return e=c.sortedIndex(d,a),d[e]===a?e:-1;e=0>b?Math.max(0,f+b):b}if(x&&d.indexOf===x)return d.indexOf(a,b);for(;f>e;e++)if(d[e]===a)return e;return-1};c.lastIndexOf=function(d,a,
b){if(null==d)return-1;var c=null!=b;if(M&&d.lastIndexOf===M)return c?d.lastIndexOf(a,b):d.lastIndexOf(a);for(b=c?b:d.length;b--;)if(d[b]===a)return b;return-1};c.range=function(d,a,b){1>=arguments.length&&(a=d||0,d=0);b=arguments[2]||1;for(var c=Math.max(Math.ceil((a-d)/b),0),e=0,f=Array(c);c>e;)f[e++]=d,d+=b;return f};var G=function(){};c.bind=function(a,b){var e,f;if(E&&a.bind===E)return E.apply(a,m.call(arguments,1));if(!c.isFunction(a))throw new TypeError;return e=m.call(arguments,2),f=function(){if(!(this instanceof
f))return a.apply(b,e.concat(m.call(arguments)));G.prototype=a.prototype;var c=new G;G.prototype=null;var g=a.apply(c,e.concat(m.call(arguments)));return Object(g)===g?g:c}};c.partial=function(a){var b=m.call(arguments,1);return function(){for(var e=0,f=b.slice(),g=0,h=f.length;h>g;g++)f[g]===c&&(f[g]=arguments[e++]);for(;e<arguments.length;)f.push(arguments[e++]);return a.apply(this,f)}};c.bindAll=function(a){var b=m.call(arguments,1);if(0===b.length)throw Error("bindAll must be passed function names");
return l(b,function(b){a[b]=c.bind(a[b],a)}),a};c.memoize=function(a,b){var e={};return b||(b=c.identity),function(){var f=b.apply(this,arguments);return c.has(e,f)?e[f]:e[f]=a.apply(this,arguments)}};c.delay=function(a,b){var c=m.call(arguments,2);return setTimeout(function(){return a.apply(null,c)},b)};c.defer=function(a){return c.delay.apply(c,[a,1].concat(m.call(arguments,1)))};c.throttle=function(a,b,e){var f,g,h,k=null,m=0;e||(e={});var n=function(){m=!1===e.leading?0:c.now();k=null;h=a.apply(f,
g);f=g=null};return function(){var l=c.now();m||!1!==e.leading||(m=l);var p=b-(l-m);return f=this,g=arguments,0>=p?(clearTimeout(k),k=null,m=l,h=a.apply(f,g),f=g=null):k||!1===e.trailing||(k=setTimeout(n,p)),h}};c.debounce=function(a,b,e){var f,g,h,k,m,l=function(){var n=c.now()-k;b>n?f=setTimeout(l,b-n):(f=null,e||(m=a.apply(h,g),h=g=null))};return function(){h=this;g=arguments;k=c.now();var n=e&&!f;return f||(f=setTimeout(l,b)),n&&(m=a.apply(h,g),h=g=null),m}};c.once=function(a){var b,c=!1;return function(){return c?
b:(c=!0,b=a.apply(this,arguments),a=null,b)}};c.wrap=function(a,b){return c.partial(b,a)};c.compose=function(){var a=arguments;return function(){for(var b=arguments,c=a.length-1;0<=c;c--)b=[a[c].apply(this,b)];return b[0]}};c.after=function(a,b){return function(){return 1>--a?b.apply(this,arguments):void 0}};c.keys=function(a){if(!c.isObject(a))return[];if(N)return N(a);var b=[],e;for(e in a)c.has(a,e)&&b.push(e);return b};c.values=function(a){for(var b=c.keys(a),e=b.length,f=Array(e),g=0;e>g;g++)f[g]=
a[b[g]];return f};c.pairs=function(a){for(var b=c.keys(a),e=b.length,f=Array(e),g=0;e>g;g++)f[g]=[b[g],a[b[g]]];return f};c.invert=function(a){for(var b={},e=c.keys(a),f=0,g=e.length;g>f;f++)b[a[e[f]]]=e[f];return b};c.functions=c.methods=function(a){var b=[],e;for(e in a)c.isFunction(a[e])&&b.push(e);return b.sort()};c.extend=function(a){return l(m.call(arguments,1),function(b){if(b)for(var e in b)a[e]=b[e]}),a};c.pick=function(a){var b={},e=q.apply(n,m.call(arguments,1));return l(e,function(e){e in
a&&(b[e]=a[e])}),b};c.omit=function(a){var b={},e=q.apply(n,m.call(arguments,1)),f;for(f in a)c.contains(e,f)||(b[f]=a[f]);return b};c.defaults=function(a){return l(m.call(arguments,1),function(b){if(b)for(var e in b)void 0===a[e]&&(a[e]=b[e])}),a};c.clone=function(a){return c.isObject(a)?c.isArray(a)?a.slice():c.extend({},a):a};c.tap=function(a,b){return b(a),a};var H=function(a,b,e,f){if(a===b)return 0!==a||1/a==1/b;if(null==a||null==b)return a===b;a instanceof c&&(a=a._wrapped);b instanceof c&&
(b=b._wrapped);var g=v.call(a);if(g!=v.call(b))return!1;switch(g){case "[object String]":return a==String(b);case "[object Number]":return a!=+a?b!=+b:0==a?1/a==1/b:a==+b;case "[object Date]":case "[object Boolean]":return+a==+b;case "[object RegExp]":return a.source==b.source&&a.global==b.global&&a.multiline==b.multiline&&a.ignoreCase==b.ignoreCase}if("object"!=typeof a||"object"!=typeof b)return!1;for(var h=e.length;h--;)if(e[h]==a)return f[h]==b;var h=a.constructor,k=b.constructor;if(h!==k&&!(c.isFunction(h)&&
h instanceof h&&c.isFunction(k)&&k instanceof k)&&"constructor"in a&&"constructor"in b)return!1;e.push(a);f.push(b);h=0;k=!0;if("[object Array]"==g){if(h=a.length,k=h==b.length)for(;h--&&(k=H(a[h],b[h],e,f)););}else{for(var m in a)if(c.has(a,m)&&(h++,!(k=c.has(b,m)&&H(a[m],b[m],e,f))))break;if(k){for(m in b)if(c.has(b,m)&&!h--)break;k=!h}}return e.pop(),f.pop(),k};c.isEqual=function(a,b){return H(a,b,[],[])};c.isEmpty=function(a){if(null==a)return!0;if(c.isArray(a)||c.isString(a))return 0===a.length;
for(var b in a)if(c.has(a,b))return!1;return!0};c.isElement=function(a){return!(!a||1!==a.nodeType)};c.isArray=r||function(a){return"[object Array]"==v.call(a)};c.isObject=function(a){return a===Object(a)};l("Arguments Function String Number Date RegExp".split(" "),function(a){c["is"+a]=function(b){return v.call(b)=="[object "+a+"]"}});c.isArguments(arguments)||(c.isArguments=function(a){return!(!a||!c.has(a,"callee"))});"function"!=typeof/./&&(c.isFunction=function(a){return"function"==typeof a});
c.isFinite=function(a){return isFinite(a)&&!isNaN(parseFloat(a))};c.isNaN=function(a){return c.isNumber(a)&&a!=+a};c.isBoolean=function(a){return!0===a||!1===a||"[object Boolean]"==v.call(a)};c.isNull=function(a){return null===a};c.isUndefined=function(a){return void 0===a};c.has=function(a,b){return z.call(a,b)};c.noConflict=function(){return p._=k,this};c.identity=function(a){return a};c.constant=function(a){return function(){return a}};c.property=function(a){return function(b){return b[a]}};c.matches=
function(a){return function(b){if(b===a)return!0;for(var e in a)if(a[e]!==b[e])return!1;return!0}};c.times=function(a,b,e){for(var c=Array(Math.max(0,a)),f=0;a>f;f++)c[f]=b.call(e,f);return c};c.random=function(a,b){return null==b&&(b=a,a=0),a+Math.floor(Math.random()*(b-a+1))};c.now=Date.now||function(){return(new Date).getTime()};var u={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;"}};u.unescape=c.invert(u.escape);var C={escape:new RegExp("["+c.keys(u.escape).join("")+"]","g"),
unescape:new RegExp("("+c.keys(u.unescape).join("|")+")","g")};c.each(["escape","unescape"],function(a){c[a]=function(b){return null==b?"":(""+b).replace(C[a],function(b){return u[a][b]})}});c.result=function(a,b){if(null!=a){var e=a[b];return c.isFunction(e)?e.call(a):e}};c.mixin=function(a){l(c.functions(a),function(b){var e=c[b]=a[b];c.prototype[b]=function(){var a=[this._wrapped];return s.apply(a,arguments),g.call(this,e.apply(c,a))}})};var a=0;c.uniqueId=function(b){var e=++a+"";return b?b+e:
e};c.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var b=/(.)^/,e={"'":"'","\\":"\\","\r":"r","\n":"n","\t":"t","\u2028":"u2028","\u2029":"u2029"},f=/\\|'|\r|\n|\t|\u2028|\u2029/g;c.template=function(a,g,h){var k;h=c.defaults({},h,c.templateSettings);var m=new RegExp([(h.escape||b).source,(h.interpolate||b).source,(h.evaluate||b).source].join("|")+"|$","g"),n=0,l="__p+='";a.replace(m,function(b,c,g,h,k){return l+=a.slice(n,k).replace(f,function(a){return"\\"+
e[a]}),c&&(l+="'+\n((__t=("+c+"))==null?'':_.escape(__t))+\n'"),g&&(l+="'+\n((__t=("+g+"))==null?'':__t)+\n'"),h&&(l+="';\n"+h+"\n__p+='"),n=k+b.length,b});l+="';\n";h.variable||(l="with(obj||{}){\n"+l+"}\n");l="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+l+"return __p;\n";try{k=new Function(h.variable||"obj","_",l)}catch(p){throw p.source=l,p;}if(g)return k(g,c);g=function(a){return k.call(this,a,c)};return g.source="function("+(h.variable||"obj")+"){\n"+
l+"}",g};c.chain=function(a){return c(a).chain()};var g=function(a){return this._chain?c(a).chain():a};c.mixin(c);l("pop push reverse shift sort splice unshift".split(" "),function(a){var b=n[a];c.prototype[a]=function(){var e=this._wrapped;return b.apply(e,arguments),"shift"!=a&&"splice"!=a||0!==e.length||delete e[0],g.call(this,e)}});l(["concat","join","slice"],function(a){var b=n[a];c.prototype[a]=function(){return g.call(this,b.apply(this._wrapped,arguments))}});c.extend(c.prototype,{chain:function(){return this._chain=
!0,this},value:function(){return this._wrapped}});"function"==typeof define&&define.amd&&define("underscore",[],function(){return c})}).call(this);
!function(p,k){if("function"==typeof define&&define.amd)define(["underscore","jquery","exports"],function(h,r,s){p.Backbone=k(p,s,h,r)});else if("undefined"!=typeof exports){var h=require("underscore");k(p,exports,h)}else p.Backbone=k(p,{},p._,p.jQuery||p.Zepto||p.ender||p.$)}(this,function(p,k,h,n){var r=p.Backbone,s=[],m=(s.push,s.slice);s.splice;k.VERSION="1.1.2";k.$=n;k.noConflict=function(){return p.Backbone=r,this};k.emulateHTTP=!1;k.emulateJSON=!1;var q=k.Events={on:function(a,b,e){if(!z(this,
"on",a,[b,e])||!b)return this;this._events||(this._events={});return(this._events[a]||(this._events[a]=[])).push({callback:b,context:e,ctx:e||this}),this},once:function(a,b,e){if(!z(this,"once",a,[b,e])||!b)return this;var c=this,g=h.once(function(){c.off(a,g);b.apply(this,arguments)});return g._callback=b,this.on(a,g,e)},off:function(a,b,e){var c,g,d,k,l,m,n,p;if(!this._events||!z(this,"off",a,[b,e]))return this;if(!a&&!b&&!e)return this._events=void 0,this;k=a?[a]:h.keys(this._events);l=0;for(m=
k.length;m>l;l++)if(a=k[l],d=this._events[a]){if(this._events[a]=c=[],b||e)for(n=0,p=d.length;p>n;n++)g=d[n],(b&&b!==g.callback&&b!==g.callback._callback||e&&e!==g.context)&&c.push(g);c.length||delete this._events[a]}return this},trigger:function(a){if(!this._events)return this;var b=m.call(arguments,1);if(!z(this,"trigger",a,b))return this;var e=this._events[a],c=this._events.all;return e&&D(e,b),c&&D(c,arguments),this},stopListening:function(a,b,e){var c=this._listeningTo;if(!c)return this;var g=
!b&&!e;e||"object"!=typeof b||(e=this);a&&((c={})[a._listenId]=a);for(var d in c)a=c[d],a.off(b,e,this),(g||h.isEmpty(a._events))&&delete this._listeningTo[d];return this}},v=/\s+/,z=function(a,b,e,c){if(!e)return!0;if("object"==typeof e){for(var g in e)a[b].apply(a,[g,e[g]].concat(c));return!1}if(v.test(e)){e=e.split(v);g=0;for(var d=e.length;d>g;g++)a[b].apply(a,[e[g]].concat(c));return!1}return!0},D=function(a,b){var e,c=-1,g=a.length,d=b[0],h=b[1],k=b[2];switch(b.length){case 0:for(;++c<g;)(e=
a[c]).callback.call(e.ctx);break;case 1:for(;++c<g;)(e=a[c]).callback.call(e.ctx,d);break;case 2:for(;++c<g;)(e=a[c]).callback.call(e.ctx,d,h);break;case 3:for(;++c<g;)(e=a[c]).callback.call(e.ctx,d,h,k);break;default:for(;++c<g;)(e=a[c]).callback.apply(e.ctx,b)}};h.each({listenTo:"on",listenToOnce:"once"},function(a,b){q[b]=function(b,c,g){var d=this._listeningTo||(this._listeningTo={}),k=b._listenId||(b._listenId=h.uniqueId("l"));return d[k]=b,g||"object"!=typeof c||(g=this),b[a](c,g,this),this}});
q.bind=q.on;q.unbind=q.off;h.extend(k,q);var y=k.Model=function(a,b){var e=a||{};b||(b={});this.cid=h.uniqueId("c");this.attributes={};b.collection&&(this.collection=b.collection);b.parse&&(e=this.parse(e,b)||{});e=h.defaults({},e,h.result(this,"defaults"));this.set(e,b);this.changed={};this.initialize.apply(this,arguments)};h.extend(y.prototype,q,{changed:null,validationError:null,idAttribute:"id",initialize:function(){},toJSON:function(){return h.clone(this.attributes)},sync:function(){return k.sync.apply(this,
arguments)},get:function(a){return this.attributes[a]},escape:function(a){return h.escape(this.get(a))},has:function(a){return null!=this.get(a)},set:function(a,b,e){var c,g,d,k,l,m,n;if(null==a)return this;if("object"==typeof a?(g=a,e=b):(g={})[a]=b,e||(e={}),!this._validate(g,e))return!1;d=e.unset;k=e.silent;a=[];l=this._changing;this._changing=!0;l||(this._previousAttributes=h.clone(this.attributes),this.changed={});n=this.attributes;m=this._previousAttributes;this.idAttribute in g&&(this.id=g[this.idAttribute]);
for(c in g)b=g[c],h.isEqual(n[c],b)||a.push(c),h.isEqual(m[c],b)?delete this.changed[c]:this.changed[c]=b,d?delete n[c]:n[c]=b;if(!k)for(a.length&&(this._pending=e),b=0,c=a.length;c>b;b++)this.trigger("change:"+a[b],this,n[a[b]],e);if(l)return this;if(!k)for(;this._pending;)e=this._pending,this._pending=!1,this.trigger("change",this,e);return this._pending=!1,this._changing=!1,this},unset:function(a,b){return this.set(a,void 0,h.extend({},b,{unset:!0}))},clear:function(a){var b={},c;for(c in this.attributes)b[c]=
void 0;return this.set(b,h.extend({},a,{unset:!0}))},hasChanged:function(a){return null==a?!h.isEmpty(this.changed):h.has(this.changed,a)},changedAttributes:function(a){if(!a)return this.hasChanged()?h.clone(this.changed):!1;var b,c=!1,f=this._changing?this._previousAttributes:this.attributes,g;for(g in a)h.isEqual(f[g],b=a[g])||((c||(c={}))[g]=b);return c},previous:function(a){return null!=a&&this._previousAttributes?this._previousAttributes[a]:null},previousAttributes:function(){return h.clone(this._previousAttributes)},
fetch:function(a){a=a?h.clone(a):{};void 0===a.parse&&(a.parse=!0);var b=this,c=a.success;return a.success=function(f){return b.set(b.parse(f,a),a)?(c&&c(b,f,a),void b.trigger("sync",b,f,a)):!1},C(this,a),this.sync("read",this,a)},save:function(a,b,c){var f,g,d,k=this.attributes;if(null==a||"object"==typeof a?(f=a,c=b):(f={})[a]=b,c=h.extend({validate:!0},c),f&&!c.wait){if(!this.set(f,c))return!1}else if(!this._validate(f,c))return!1;f&&c.wait&&(this.attributes=h.extend({},k,f));void 0===c.parse&&
(c.parse=!0);var l=this,m=c.success;return c.success=function(a){l.attributes=k;var b=l.parse(a,c);return c.wait&&(b=h.extend(f||{},b)),h.isObject(b)&&!l.set(b,c)?!1:(m&&m(l,a,c),void l.trigger("sync",l,a,c))},C(this,c),g=this.isNew()?"create":c.patch?"patch":"update","patch"===g&&(c.attrs=f),d=this.sync(g,this,c),f&&c.wait&&(this.attributes=k),d},destroy:function(a){a=a?h.clone(a):{};var b=this,c=a.success,f=function(){b.trigger("destroy",b,b.collection,a)};if(a.success=function(d){(a.wait||b.isNew())&&
f();c&&c(b,d,a);b.isNew()||b.trigger("sync",b,d,a)},this.isNew())return a.success(),!1;C(this,a);var g=this.sync("delete",this,a);return a.wait||f(),g},url:function(){var a=h.result(this,"urlRoot")||h.result(this.collection,"url")||u();return this.isNew()?a:a.replace(/([^\/])$/,"$1/")+encodeURIComponent(this.id)},parse:function(a){return a},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return!this.has(this.idAttribute)},isValid:function(a){return this._validate({},
h.extend(a||{},{validate:!0}))},_validate:function(a,b){if(!b.validate||!this.validate)return!0;a=h.extend({},this.attributes,a);var c=this.validationError=this.validate(a,b)||null;return c?(this.trigger("invalid",this,c,h.extend(b,{validationError:c})),!1):!0}});h.each("keys values pairs invert pick omit".split(" "),function(a){y.prototype[a]=function(){var b=m.call(arguments);return b.unshift(this.attributes),h[a].apply(h,b)}});var w=k.Collection=function(a,b){b||(b={});b.model&&(this.model=b.model);
void 0!==b.comparator&&(this.comparator=b.comparator);this._reset();this.initialize.apply(this,arguments);a&&this.reset(a,h.extend({silent:!0},b))},I={add:!0,remove:!0,merge:!0},J={add:!0,remove:!1};h.extend(w.prototype,q,{model:y,initialize:function(){},toJSON:function(a){return this.map(function(b){return b.toJSON(a)})},sync:function(){return k.sync.apply(this,arguments)},add:function(a,b){return this.set(a,h.extend({merge:!1},b,J))},remove:function(a,b){var c=!h.isArray(a);a=c?[a]:h.clone(a);b||
(b={});var f,g,d,k;f=0;for(g=a.length;g>f;f++)(k=a[f]=this.get(a[f]))&&(delete this._byId[k.id],delete this._byId[k.cid],d=this.indexOf(k),this.models.splice(d,1),this.length--,b.silent||(b.index=d,k.trigger("remove",k,this,b)),this._removeReference(k,b));return c?a[0]:a},set:function(a,b){b=h.defaults({},b,I);b.parse&&(a=this.parse(a,b));var c=!h.isArray(a);a=c?a?[a]:[]:h.clone(a);var f,g,d,k,l,m,n,p=b.at,q=this.model,s=this.comparator&&null==p&&!1!==b.sort,t=h.isString(this.comparator)?this.comparator:
null,r=[],v=[],u={},w=b.add,z=b.merge,x=b.remove,A=!s&&w&&x?[]:!1;f=0;for(g=a.length;g>f;f++){if(l=a[f]||{},d=l instanceof y?k=l:l[q.prototype.idAttribute||"id"],m=this.get(d))x&&(u[m.cid]=!0),z&&(l=l===k?k.attributes:l,b.parse&&(l=m.parse(l,b)),m.set(l,b),s&&!n&&m.hasChanged(t)&&(n=!0)),a[f]=m;else if(w){if(k=a[f]=this._prepareModel(l,b),!k)continue;r.push(k);this._addReference(k,b)}k=m||k;!A||!k.isNew()&&u[k.id]||A.push(k);u[k.id]=!0}if(x){f=0;for(g=this.length;g>f;++f)u[(k=this.models[f]).cid]||
v.push(k);v.length&&this.remove(v,b)}if(r.length||A&&A.length)if(s&&(n=!0),this.length+=r.length,null!=p)for(f=0,g=r.length;g>f;f++)this.models.splice(p+f,0,r[f]);else for(A&&(this.models.length=0),d=A||r,f=0,g=d.length;g>f;f++)this.models.push(d[f]);if(n&&this.sort({silent:!0}),!b.silent){f=0;for(g=r.length;g>f;f++)(k=r[f]).trigger("add",k,this,b);(n||A&&A.length)&&this.trigger("sort",this,b)}return c?a[0]:a},reset:function(a,b){b||(b={});for(var c=0,f=this.models.length;f>c;c++)this._removeReference(this.models[c],
b);return b.previousModels=this.models,this._reset(),a=this.add(a,h.extend({silent:!0},b)),b.silent||this.trigger("reset",this,b),a},push:function(a,b){return this.add(a,h.extend({at:this.length},b))},pop:function(a){var b=this.at(this.length-1);return this.remove(b,a),b},unshift:function(a,b){return this.add(a,h.extend({at:0},b))},shift:function(a){var b=this.at(0);return this.remove(b,a),b},slice:function(){return m.apply(this.models,arguments)},get:function(a){return null==a?void 0:this._byId[a]||
this._byId[a.id]||this._byId[a.cid]},at:function(a){return this.models[a]},where:function(a,b){return h.isEmpty(a)?b?void 0:[]:this[b?"find":"filter"](function(b){for(var c in a)if(a[c]!==b.get(c))return!1;return!0})},findWhere:function(a){return this.where(a,!0)},sort:function(a){if(!this.comparator)throw Error("Cannot sort a set without a comparator");return a||(a={}),h.isString(this.comparator)||1===this.comparator.length?this.models=this.sortBy(this.comparator,this):this.models.sort(h.bind(this.comparator,
this)),a.silent||this.trigger("sort",this,a),this},pluck:function(a){return h.invoke(this.models,"get",a)},fetch:function(a){a=a?h.clone(a):{};void 0===a.parse&&(a.parse=!0);var b=a.success,c=this;return a.success=function(f){c[a.reset?"reset":"set"](f,a);b&&b(c,f,a);c.trigger("sync",c,f,a)},C(this,a),this.sync("read",this,a)},create:function(a,b){if(b=b?h.clone(b):{},!(a=this._prepareModel(a,b)))return!1;b.wait||this.add(a,b);var c=this,f=b.success;return b.success=function(a,d){b.wait&&c.add(a,
b);f&&f(a,d,b)},a.save(null,b),a},parse:function(a){return a},clone:function(){return new this.constructor(this.models)},_reset:function(){this.length=0;this.models=[];this._byId={}},_prepareModel:function(a,b){if(a instanceof y)return a;b=b?h.clone(b):{};b.collection=this;var c=new this.model(a,b);return c.validationError?(this.trigger("invalid",this,c.validationError,b),!1):c},_addReference:function(a){this._byId[a.cid]=a;null!=a.id&&(this._byId[a.id]=a);a.collection||(a.collection=this);a.on("all",
this._onModelEvent,this)},_removeReference:function(a){this===a.collection&&delete a.collection;a.off("all",this._onModelEvent,this)},_onModelEvent:function(a,b,c,f){("add"!==a&&"remove"!==a||c===this)&&("destroy"===a&&this.remove(b,f),b&&a==="change:"+b.idAttribute&&(delete this._byId[b.previous(b.idAttribute)],null!=b.id&&(this._byId[b.id]=b)),this.trigger.apply(this,arguments))}});h.each("forEach each map collect reduce foldl inject reduceRight foldr find detect filter select reject every all some any include contains invoke max min toArray size first head take initial rest tail drop last without difference indexOf shuffle lastIndexOf isEmpty chain sample".split(" "),
function(a){w.prototype[a]=function(){var b=m.call(arguments);return b.unshift(this.models),h[a].apply(h,b)}});h.each(["groupBy","countBy","sortBy","indexBy"],function(a){w.prototype[a]=function(b,c){var f=h.isFunction(b)?b:function(a){return a.get(b)};return h[a](this.models,f,c)}});n=k.View=function(a){this.cid=h.uniqueId("view");a||(a={});h.extend(this,h.pick(a,L));this._ensureElement();this.initialize.apply(this,arguments);this.delegateEvents()};var K=/^(\S+)\s*(.*)$/,L="model collection el id attributes className tagName events".split(" ");
h.extend(n.prototype,q,{tagName:"div",$:function(a){return this.$el.find(a)},initialize:function(){},render:function(){return this},remove:function(){return this.$el.remove(),this.stopListening(),this},setElement:function(a,b){return this.$el&&this.undelegateEvents(),this.$el=a instanceof k.$?a:k.$(a),this.el=this.$el[0],!1!==b&&this.delegateEvents(),this},delegateEvents:function(a){if(!a&&!(a=h.result(this,"events")))return this;this.undelegateEvents();for(var b in a){var c=a[b];if(h.isFunction(c)||
(c=this[a[b]]),c){var f=b.match(K),g=f[1],f=f[2],c=h.bind(c,this),g=g+(".delegateEvents"+this.cid);""===f?this.$el.on(g,c):this.$el.on(g,f,c)}}return this},undelegateEvents:function(){return this.$el.off(".delegateEvents"+this.cid),this},_ensureElement:function(){if(this.el)this.setElement(h.result(this,"el"),!1);else{var a=h.extend({},h.result(this,"attributes"));this.id&&(a.id=h.result(this,"id"));this.className&&(a["class"]=h.result(this,"className"));a=k.$("<"+h.result(this,"tagName")+">").attr(a);
this.setElement(a,!1)}}});k.sync=function(a,b,c){var f=M[a];h.defaults(c||(c={}),{emulateHTTP:k.emulateHTTP,emulateJSON:k.emulateJSON});var g={type:f,dataType:"json"};if(c.url||(g.url=h.result(b,"url")||u()),null!=c.data||!b||"create"!==a&&"update"!==a&&"patch"!==a||(g.contentType="application/json",g.data=JSON.stringify(c.attrs||b.toJSON(c))),c.emulateJSON&&(g.contentType="application/x-www-form-urlencoded",g.data=g.data?{model:g.data}:{}),c.emulateHTTP&&("PUT"===f||"DELETE"===f||"PATCH"===f)){g.type=
"POST";c.emulateJSON&&(g.data._method=f);var d=c.beforeSend;c.beforeSend=function(a){return a.setRequestHeader("X-HTTP-Method-Override",f),d?d.apply(this,arguments):void 0}}"GET"===g.type||c.emulateJSON||(g.processData=!1);"PATCH"===g.type&&x&&(g.xhr=function(){return new ActiveXObject("Microsoft.XMLHTTP")});a=c.xhr=k.ajax(h.extend(g,c));return b.trigger("request",b,a,c),a};var x=!("undefined"==typeof window||!window.ActiveXObject||window.XMLHttpRequest&&(new XMLHttpRequest).dispatchEvent),M={create:"POST",
update:"PUT",patch:"PATCH","delete":"DELETE",read:"GET"};k.ajax=function(){return k.$.ajax.apply(k.$,arguments)};var s=k.Router=function(a){a||(a={});a.routes&&(this.routes=a.routes);this._bindRoutes();this.initialize.apply(this,arguments)},N=/\((.*?)\)/g,E=/(\(\?)?:\w+/g,c=/\*\w+/g,l=/[\-{}\[\]+?.,\\\^$|#\s]/g;h.extend(s.prototype,q,{initialize:function(){},route:function(a,b,c){h.isRegExp(a)||(a=this._routeToRegExp(a));h.isFunction(b)&&(c=b,b="");c||(c=this[b]);var f=this;return k.history.route(a,
function(g){g=f._extractParameters(a,g);f.execute(c,g);f.trigger.apply(f,["route:"+b].concat(g));f.trigger("route",b,g);k.history.trigger("route",f,b,g)}),this},execute:function(a,b){a&&a.apply(this,b)},navigate:function(a,b){return k.history.navigate(a,b),this},_bindRoutes:function(){if(this.routes){this.routes=h.result(this,"routes");for(var a,b=h.keys(this.routes);null!=(a=b.pop());)this.route(a,this.routes[a])}},_routeToRegExp:function(a){return a=a.replace(l,"\\$&").replace(N,"(?:$1)?").replace(E,
function(a,c){return c?a:"([^/?]+)"}).replace(c,"([^?]*?)"),new RegExp("^"+a+"(?:\\?([\\s\\S]*))?$")},_extractParameters:function(a,b){var c=a.exec(b).slice(1);return h.map(c,function(a,b){return b===c.length-1?a||null:a?decodeURIComponent(a):null})}});var t=k.History=function(){this.handlers=[];h.bindAll(this,"checkUrl");"undefined"!=typeof window&&(this.location=window.location,this.history=window.history)},B=/^[#\/]|\s+$/g,F=/^\/+|\/+$/g,O=/msie [\w.]+/,G=/\/$/,H=/#.*$/;t.started=!1;h.extend(t.prototype,
q,{interval:50,atRoot:function(){return this.location.pathname.replace(/[^\/]$/,"$&/")===this.root},getHash:function(a){return(a=(a||this).location.href.match(/#(.*)$/))?a[1]:""},getFragment:function(a,b){if(null==a)if(this._hasPushState||!this._wantsHashChange||b){a=decodeURI(this.location.pathname+this.location.search);var c=this.root.replace(G,"");a.indexOf(c)||(a=a.slice(c.length))}else a=this.getHash();return a.replace(B,"")},start:function(a){if(t.started)throw Error("Backbone.history has already been started");
t.started=!0;this.options=h.extend({root:"/"},this.options,a);this.root=this.options.root;this._wantsHashChange=!1!==this.options.hashChange;this._wantsPushState=!!this.options.pushState;this._hasPushState=!!(this.options.pushState&&this.history&&this.history.pushState);a=this.getFragment();var b=document.documentMode,b=O.exec(navigator.userAgent.toLowerCase())&&(!b||7>=b);if(this.root=("/"+this.root+"/").replace(F,"/"),b&&this._wantsHashChange)this.iframe=k.$('<iframe src="javascript:0" tabindex="-1">').hide().appendTo("body")[0].contentWindow,
this.navigate(a);this._hasPushState?k.$(window).on("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!b?k.$(window).on("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval));this.fragment=a;a=this.location;if(this._wantsHashChange&&this._wantsPushState){if(!this._hasPushState&&!this.atRoot())return this.fragment=this.getFragment(null,!0),this.location.replace(this.root+"#"+this.fragment),!0;this._hasPushState&&this.atRoot()&&
a.hash&&(this.fragment=this.getHash().replace(B,""),this.history.replaceState({},document.title,this.root+this.fragment))}return this.options.silent?void 0:this.loadUrl()},stop:function(){k.$(window).off("popstate",this.checkUrl).off("hashchange",this.checkUrl);this._checkUrlInterval&&clearInterval(this._checkUrlInterval);t.started=!1},route:function(a,b){this.handlers.unshift({route:a,callback:b})},checkUrl:function(){var a=this.getFragment();return a===this.fragment&&this.iframe&&(a=this.getFragment(this.getHash(this.iframe))),
a===this.fragment?!1:(this.iframe&&this.navigate(a),void this.loadUrl())},loadUrl:function(a){return a=this.fragment=this.getFragment(a),h.any(this.handlers,function(b){return b.route.test(a)?(b.callback(a),!0):void 0})},navigate:function(a,b){if(!t.started)return!1;b&&!0!==b||(b={trigger:!!b});var c=this.root+(a=this.getFragment(a||""));if(a=a.replace(H,""),this.fragment!==a){if(this.fragment=a,""===a&&"/"!==c&&(c=c.slice(0,-1)),this._hasPushState)this.history[b.replace?"replaceState":"pushState"]({},
document.title,c);else{if(!this._wantsHashChange)return this.location.assign(c);this._updateHash(this.location,a,b.replace);this.iframe&&a!==this.getFragment(this.getHash(this.iframe))&&(b.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,a,b.replace))}return b.trigger?this.loadUrl(a):void 0}},_updateHash:function(a,b,c){c?(c=a.href.replace(/(javascript:|#).*$/,""),a.replace(c+"#"+b)):a.hash="#"+b}});k.history=new t;y.extend=w.extend=s.extend=n.extend=t.extend=function(a,
b){var c,f=this;c=a&&h.has(a,"constructor")?a.constructor:function(){return f.apply(this,arguments)};h.extend(c,f,b);var g=function(){this.constructor=c};return g.prototype=f.prototype,c.prototype=new g,a&&h.extend(c.prototype,a),c.__super__=f.prototype,c};var u=function(){throw Error('A "url" property or function must be specified');},C=function(a,b){var c=b.error;b.error=function(f){c&&c(a,f,b);a.trigger("error",a,f,b)}};return k});